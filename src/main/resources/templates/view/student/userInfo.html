<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title></title>
    <link href="/style/steam_front/reset.css" rel="stylesheet" type="text/css"/>
    <link rel="stylesheet" href="/style/findSchool/css/xuexiao.css"/>
    <link href="/style/steam_front/user_datum/css/user_datum.css" rel="stylesheet" type="text/css"/>
    <style>
        .headImg {
            float: left;
            margin-right: 10px;
        }

        .headImg img {
            width: 4.6rem
        }
    </style>
</head>

<body>
<!--/*@thymesVar id="login_user" type="org.ck.teach.teachplatform.entity.User"*/-->
<link href="/style/jw/css/base.css" rel="stylesheet" type="text/css"/>
<link rel="stylesheet" type="text/css" href="/style/blackbox/css/blackbox.css" media="screen"/>
<link href="/style/basic/loadmask.css" rel="stylesheet" type="text/css"/>

<div th:replace="view/frame/head :: head-div(index=6)"></div>
<div th:include="view/frame/userHead::subHead(index=1)"></div>
<div id="p_link" th:include="view/frame/links :: p_links(l1='',name1='个人中心',l2='',name2='个人资料')">
</div>


<div class="layui-container">
    <div class="layui-tab layui-tab-card">
        <ul class="layui-tab-title">
            <li class="layui-this">个人设置</li>
            <li>主页预览</li>
        </ul>
        <div class="layui-tab-content" >
            <div class="layui-tab-item layui-show">

                <div class="q_ud_main">
                    <div class="q_ud_setData">
                        <div class="q_ud_substance layui-form">
                            <input value="" name="id" type="hidden" th:value="${login_user.getId()}">
                            <fieldset class="layui-elem-field layui-field-title" style="margin-top: 30px;">
                                <legend>基础信息</legend>
                            </fieldset>
                            <div class="q_ud_picture layui-row">
                                <div class="layui-form-item layui-col-sm6">
                                    <div class="layui-form-label">
                                        上传头像
                                    </div>
                                    <div class="layui-input-block">
                                        <div class="layui-upload-drag" id="test10">
                                            <i class="layui-icon"></i>
                                            <p>上传头像</p>
                                        </div>

                                        <div class="layui-upload-drag headImg">
                                            <img id="headImg" src="/style/back/image/tou_c.jpg"
                                                 th:src="${login_user.getHeadUrl()}">
                                        </div>
                                        <input type="hidden" id="headUrl" name="headUrl" th:value="${login_user.getHeadUrl()}">
                                    </div>
                                </div>
                                <div class="layui-form-item layui-col-sm6">
                                    <label class="layui-form-label">昵称</label>
                                    <div class="layui-input-block">
                                        <input type="text" name="nickName" lay-verify="required" lay-reqtext="用户名是必填项，岂能为空？"
                                               placeholder="请输入" th:value="${login_user.getNickName()}" autocomplete="off"
                                               class="layui-input">
                                    </div>
                                </div>

                                <div class="layui-form-item layui-col-sm6">
                                    <label class="layui-form-label">称号</label>
                                    <div class="layui-input-block">
                                        <input type="text" lay-verify="required" lay-reqtext="用户名是必填项，岂能为空？"
                                               placeholder="请输入" th:value="${login_user.getPointLevel()}"
                                               autocomplete="off" class="layui-input layui-disabled">
                                    </div>
                                </div>
                                <div class="layui-form-item layui-col-sm6">
                                    <label class="layui-form-label">积分</label>
                                    <div class="layui-input-block">
                                        <input type="text" lay-verify="required" lay-reqtext="用户名是必填项，岂能为空？"
                                               th:value="${login_user.getPoint()}"
                                               placeholder="请输入" autocomplete="off" class="layui-input layui-disabled">
                                    </div>
                                </div>
                                <div class="layui-form-item layui-col-sm6">
                                    <label class="layui-form-label">用户身份</label>
                                    <div class="layui-input-block ">
                                        <input type="radio" name="roleId" value="1" title="学生" disabled
                                               th:attr="checked=${login_user.getRoleId()==1?'true':'false'}">
                                        <input type="radio" name="roleId" value="2" title="教师" disabled
                                               th:attr="checked=${login_user.getRoleId()==2?'true':'false'}">
                                    </div>
                                </div>


                                <div class="layui-form-item layui-col-sm6">
                                    <label class="layui-form-label">学校</label>
                                    <div class="layui-input-block">
                                        <input type="text" name="school" lay-verify="required" lay-reqtext="用户名是必填项，岂能为空？"
                                               th:value="${login_user.getSchool()}"
                                               placeholder="请输入school" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                                <div class="layui-form-item layui-col-sm9">
                                    <label class="layui-form-label">简介</label>
                                    <div class="layui-input-block">
                                <textarea class="layui-textarea"
                                          th:text="${login_user.getIntro()}"
                                          name="intro"></textarea>
                                    </div>
                                </div>

                            </div>
                            <fieldset class="layui-elem-field layui-field-title" style="margin-top: 30px;">
                                <legend>隐私设置</legend>
                            </fieldset>
                            <div class="q_ud_data">
                                <div class="layui-form-item layui-col-sm6">
                                    <label class="layui-form-label">手机号码</label>
                                    <div class="layui-input-block">
                                        <input type="text" name="phone" lay-verify="required" lay-reqtext=" 岂能为空？"
                                               th:value="${login_user.getPhone()}"
                                               placeholder="请输入" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                                <div class="layui-form-item layui-col-sm6">
                                    <label class="layui-form-label">密码</label>
                                    <div class="layui-input-block">
                                        <input type="password" name="password" lay-verify="required" lay-reqtext=" 岂能为空？"
                                               th:value="${login_user.getPassword()}"
                                               placeholder="为空不修改" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                                <div class="layui-form-item layui-col-sm6">
                                    <label class="layui-form-label"></label>
                                    <div class="layui-input-block">
                                        <button class="btn-primary layui-btn" lay-submit lay-filter="update-user-btn">保存
                                        </button>
                                    </div>
                                </div>
                                <div class="clear"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="layui-tab-item" >
                <div style="min-height: 600px;margin: 30px;">
                    <button class="layui-btn layui-btn-primary" style="">
                        <a  th:href="'/user/other/info/'+${login_user.getId()}" target="_blank" ><i class="layui-icon-release layui-icon"></i>点击查看预览</a>
                    </button>
                </div>

            </div>
        </div>
    </div>

</div>
<script>
    layui.use(['js_tools', 'upload', 'layedit', 'form', 'jquery'], function () {
        var upload = layui.upload;
        var $ = layui.jquery;
        var js_tools = layui.js_tools;
        var form = layui.form;
        var layedit = layui.layedit;

        form.on('submit(update-user-btn)', function (data) {
            var arg = data.field;
            delete arg.file;
            console.log(arg);
            js_tools.sync_post('/admin/api/user/update', arg, function (res) {
                layer.alert('修改成功', function () {
                    location.reload();
                });
            }, null);
        });
        //拖拽上传
        upload.render({
            elem: '#test10'
            , url: '/upload'
            , done: function (res) {
                layer.msg(res.msg);
                if (res.code == js_tools.successCode) {
                    console.log(res.body.path);
                    $('#headUrl').val(res.body.path);
                    $('#headImg').attr('src', res.body.path);
                }
            }
        });

    })
</script>
</body>
</html>



























